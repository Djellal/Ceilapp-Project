@page "/student-dashboard"
@using Ceilapp.Models.ceilapp
@attribute [Authorize]
<PageTitle>Tableau de bord étudiant</PageTitle>
<div class="container-fluid py-4">
    <RadzenStack Gap="2rem">
        <RadzenCard class="shadow-lg rounded-4 border-0">
            <RadzenCardHeader class="bg-primary bg-opacity-10 border-bottom">
                <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="1rem" JustifyContent="Radzen.JustifyContent.SpaceBetween">
                    <i class="bi bi-calendar-check fs-3 text-primary"></i>
                    <RadzenText TextStyle="TextStyle.H5" class="mb-0 fw-bold">Inscriptions de la session actuelle</RadzenText>
                    <RadzenButton Text="S'inscrire à un cours" Icon="add_circle" ButtonStyle="Radzen.ButtonStyle.Success" Class="mt-3" Click="@Button0Click" />
                </RadzenStack>
            </RadzenCardHeader>
            <div class="p-4">
                @if (currentRegistrations == null || !currentRegistrations.Any())
                {
                    <div class="text-center p-5">
                        <i class="bi bi-inbox fs-1 text-muted opacity-50"></i>
                        <p class="mt-3 text-muted">Aucune inscription trouvée pour la session actuelle</p>                        
                    </div>
                }
                else
                {
                    <RadzenDataList TItem="CourseRegistration" Data="@currentRegistrations" WrapItems="true">
                        <Template>
                            <RadzenCard class="mb-4 shadow-sm hover-shadow transition-all">
                            
                                <RadzenStack Gap="1.5rem" Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.Start" AlignItems="Radzen.AlignItems.Center">
                                <RadzenImage Path="@context.Course?.Image" Style="width: 64px; height: 64px"></RadzenImage>
                                    <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.Start" Gap="1rem" Class="align-items-center">
                                        <div class="bg-primary bg-opacity-10 p-3 rounded-circle">
                                            
                                        </div>
                                        <RadzenText TextStyle="TextStyle.H5" class="mb-0 fw-bold">@context.Course?.Name</RadzenText>
                                    </RadzenStack>
                                    
                                    <RadzenStack Orientation="Orientation.Horizontal" Gap="2rem" Class="text-muted flex-wrap">
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-hash me-2 text-primary"></i>
                                            <span class="fw-semibold">@context.InscriptionCode</span>
                                        </div>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-bar-chart me-2 text-primary"></i>
                                            <span>@context.CourseLevel?.Name</span>
                                        </div>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-calendar3 me-2 text-primary"></i>
                                            <span>@context.RegistrationDate.ToString("dd/MM/yyyy")</span>
                                        </div>
                                        <div>
                                            @if (context.RegistrationValidated)
                                            {
                                                <span class="badge rounded-pill bg-success-subtle text-success px-3 py-2">
                                                    <i class="bi bi-check-circle me-1"></i>Validée
                                                </span>
                                                                                           
                                            }
                                            else
                                            {
                                                <span class="badge rounded-pill bg-warning-subtle text-warning px-3 py-2">
                                                    <i class="bi bi-clock me-1"></i>En attente
                                                </span>
                                            }
                                        </div>                                        
                                        <div><RadzenLink Text="Voir les détails de l'inscription" Path="@($"/edit-course-registration/false/{context.Id}")" Icon="visibility"></RadzenLink></div>
                                    </RadzenStack>
                                </RadzenStack>
                                
                            </RadzenCard>
                        </Template>
                    </RadzenDataList>
                }
            </div>
        </RadzenCard>

         <RadzenCard class="shadow-lg rounded-4 border-0">
            <RadzenCardHeader class="bg-primary bg-opacity-10 border-bottom">
                <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="1rem">
                    <i class="bi bi-calendar-check fs-3 text-primary"></i>
                    <RadzenText TextStyle="TextStyle.H5" class="mb-0 fw-bold">Inscriptions des sessions précédentes</RadzenText>
                </RadzenStack>
            </RadzenCardHeader>
            <div class="p-4">
                @if (previousRegistrations == null || !previousRegistrations.Any())
                {
                    <div class="text-center p-5">
                        <i class="bi bi-inbox fs-1 text-muted opacity-50"></i>
                        <p class="mt-3 text-muted">Aucune inscription trouvée pour les sessions précédentes</p>
                        <RadzenButton Text="S'inscrire à un cours" Icon="add_circle" ButtonStyle="ButtonStyle.Light" Class="mt-3" />
                    </div>
                }
                else
                {
                    <RadzenDataList TItem="CourseRegistration" Data="@previousRegistrations" WrapItems="true">
                        <Template>
                            <RadzenCard class="mb-4 shadow-sm hover-shadow transition-all">
                            
                                <RadzenStack Gap="1.5rem" Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.Start" AlignItems="Radzen.AlignItems.Center">
                                <RadzenImage Path="@context.Course?.Image" Style="width: 64px; height: 64px"></RadzenImage>
                                    <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.Start" Gap="1rem" Class="align-items-center">
                                        <div class="bg-primary bg-opacity-10 p-3 rounded-circle">
                                            
                                        </div>
                                        <RadzenText TextStyle="TextStyle.H5" class="mb-0 fw-bold">@context.Course?.Name</RadzenText>
                                    </RadzenStack>
                                    
                                    <RadzenStack Orientation="Orientation.Horizontal" Gap="2rem" Class="text-muted flex-wrap">
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-hash me-2 text-primary"></i>
                                            <span class="fw-semibold">@context.InscriptionCode</span>
                                        </div>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-bar-chart me-2 text-primary"></i>
                                            <span>@context.CourseLevel?.Name</span>
                                        </div>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-calendar3 me-2 text-primary"></i>
                                            <span>@context.RegistrationDate.ToString("dd/MM/yyyy")</span>
                                        </div>
                                        <div>
                                            @if (context.RegistrationValidated)
                                            {
                                                <span class="badge rounded-pill bg-success-subtle text-success px-3 py-2">
                                                    <i class="bi bi-check-circle me-1"></i>Validée
                                                </span>
                                                                                           
                                            }
                                            else
                                            {
                                                <span class="badge rounded-pill bg-warning-subtle text-warning px-3 py-2">
                                                    <i class="bi bi-clock me-1"></i>En attente
                                                </span>
                                            }
                                        </div>                                        
                                        <div><RadzenLink Text="Voir les détails de l'inscription" Path="@($"/edit-course-registration/false/{context.Id}")" Icon="visibility"></RadzenLink></div>
                                    </RadzenStack>
                                </RadzenStack>
                                
                            </RadzenCard>
                        </Template>
                    </RadzenDataList>
                }
            </div>
        </RadzenCard>
       
    </RadzenStack>
</div>
